README.md
>ì‘ì„±ì : ì‹ ê¸°ì—°
---
í”„ë¡œì íŠ¸ ì‹œì‘ì¼ 
---
2020/06/02 ~  2020/07/07

---
ì™„ì„±ì¼
---
ë¯¸ì •

---
í”„ë¡œì íŠ¸ ì´ë¦„
---
- ìì „ê±° ëŒ€ì—¬ í™ˆí˜ì´ì§€
 ---
í”„ë¡œì íŠ¸ ì¸ì› ë° íŒ€ì›
---
 - ì‹ ê¸°ì—°, ì£¼ì¥ìµ, ê¹€ì¤€ì˜, ì„±ê¸°ì›, ê°„ì˜ˆì€ (ì´ 5ëª…)  
 
  
 ë§¡ì€ ê¸°ëŠ¥  
---
  - ì£¼ì¥ìµ : ë¬¼í’ˆ ì˜ˆì•½, ë“±ë¡ ê¸°ëŠ¥ ë° ìƒì„¸í˜ì´ì§€ UI  
  - ì‹ ê¸°ì—° : Security ë¥¼ ì´ìš©í•œ ì „ì²´ì ì¸ ë³´ì•ˆ ë° ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒ/íšŒì›ê°€ì… ë“± ì „ë°˜ì ì¸ í‹€  
  - ì„±ê¸°ì›, ê¹€ì¤€ì˜ : ìœ ì € ê²Œì‹œíŒ ë“±ë¡, ì‚­ì œ, ìˆ˜ì • ë“± CRUD ê¸°ëŠ¥ ì™¸  +@ (ëŒ“ê¸€ ë“±)  
  - ê°„ì˜ˆì€ : ìœ ì € ë§ˆì´í˜ì´ì§€ì˜ ì „ì²´ì ì¸ ê¸°ëŠ¥ ë° ë©”ì¸ UI ìˆ˜ì • ë“±  
 ---
ì‚¬ìš©í•œ ì–¸ì–´ ë° í”„ë ˆì„ì›Œí¬  
---
- HTML5, CSS3, JS, JQUERY, AJAX (FRONT END)
 - JAVA, JSP (BACKEND)
 - SPRING, SPRING-SECURITY (Spring FrameWork ) 
 - Oracle DataBase (11g) , Mybatis (ë§ˆì´ë°”í‹°ìŠ¤)
 ---
 
í”„ë¡œì íŠ¸ì— ì‚¬ìš© ëœ ê¸°ìˆ  ë° ë„£ì€ ê¸°ëŠ¥  
---
 - Https ë° ì¸ì¦ì„œ (kettool) ì ìš©    
 ![https](https://user-images.githubusercontent.com/64994827/84469843-f73caf80-acbc-11ea-87cd-8f674887e331.png)
 - Spring frameworkë¥¼ ì‚¬ìš©í•˜ì—¬ MVC pattrenì„ ì‚¬ìš©.
 - JSP ì™€ Ajax ë¥¼ ì´ìš©í•œ ì‹¤ì‹œê°„ ì¢‹ì•„ìš”/ì‹«ì–´ìš”, ëŒ“ê¸€ ì¶”ê°€/ì‚­ì œ ê¸°ëŠ¥
 - Ajaxë¥¼ ì´ìš©í•œ íšŒì› ì‹¤ì‹œê°„ ê´€ë¦¬ ê¸°ëŠ¥
 - ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ë° ì•„ì´ë”” ì°¾ê¸° ê¸°ëŠ¥
 - Spring security ì˜ ì•”í˜¸í™”ë¥¼ ì´ìš©í•œ ë¹„ë°€ë²ˆí˜¸ ë³´ì•ˆ
 - Spring security ë¥¼ ì‚¬ìš©í•˜ì—¬, ê´€ë¦¬ì/íšŒì›/ë¹„íšŒì› ê¶Œí•œ ë¶€ì—¬.
 - Spring security ë¥¼ ì‚¬ìš©í•œ ë¡œê·¸ì¸, ë¡œê·¸ì•„ì›ƒ ì‹œ ê¶Œí•œ ì¸ì¦ì„ í†µí•œ ê¸°ëŠ¥
 - Spring securityì˜ Remember-me ë¥¼ ì´ìš©í•œ ìë™ ë¡œê·¸ì¸ ê¸°ëŠ¥ 
 - ChatJsë¥¼ ì´ìš©í•œ ì˜ˆì•½ ë‚ ì§œ & ì‚¬ìš©í•œ ê¸ˆì•¡ í™•ì¸ ê¸°ëŠ¥
 - ê´€ë¦¬ì í˜ì´ì§€ì™€ ìœ ì € ë§ˆì´í˜ì´ì§€ì—ì„œ ì „ì²´ ê´€ë¦¬ ê¸°ëŠ¥
 - ë¡œê·¸ì¸ íšŸìˆ˜, ë¡œê·¸ì¸ ëˆ„ì  ì‹¤íŒ¨ íšŸìˆ˜ , ì˜ˆì•½ íšŸìˆ˜ í™•ì¸ ê¸°ëŠ¥
 - ë¬¼í’ˆ ë“±ë¡ ë° ë¬¼í’ˆ ì˜ˆì•½ & í™•ì¸ ê¸°ëŠ¥ 
 - ì˜ˆì•½ ë¬¸ì˜ ê¸°ëŠ¥ ë° 1 : 1 ë¬¸ì˜ ê¸°ëŠ¥ 
 - JS (Javascript) ë¥¼ ì´ìš©í•´ì„œ ìœ íš¨ì„± ê²€ì‚¬ ê¸°ëŠ¥
 - Mybatis ë¥¼ ì´ìš©í•˜ì—¬ DBë¥¼ Dynamic sql ë¡œ ì œì–´ ë° ë°ì´í„° ì €ì¥/ì¶œë ¥  
 - Mybatisë¥¼ ì´ìš©í•œ CRUD  + @ 
 - ìœ ì € ì†Œí†µ ê²Œì‹œíŒ ( + ëŒ“ê¸€ ì¶”ê°€/ì‚­ì œ  : SummerNote / NaverEditorNote ë“± ) (ê¹€ì¤€ì˜/ì„±ê¸°ì›)
 - ìœ ì €ì˜ ë Œíƒˆ ëŒ€ì—¬ ì‹œìŠ¤í…œ ë“±ë¡ì ì‹ ì²­ ê¸°ëŠ¥ (ğŸ¥ˆì£¼ì¥ìµ)
 - êµ¬ì…ì í˜„í™© ( ë“±ë¡ìì—ê²Œ ìê¸°ê°€ ì˜¬ë¦° ë¬¼í’ˆ ì˜ˆì•½í•œ ì‚¬ëŒ(ìœ ì €) ë³´ì—¬ì£¼ê¸° )(ğŸ¥ˆì£¼ì¥ìµ) 
 - ë¬¼í’ˆ ë° ì˜ˆì•½ì í˜„í™© ë‚ ì§œ ê²€ìƒ‰ ê¸°ëŠ¥ (ê°„ì˜ˆì€)
 - ì‹¤ì‹œê°„ ì¹´ë“œ ê°¯ìˆ˜ í™•ì¸ ë° ì¹´ë“œ/ì˜ˆì•½ ê¸°ëŠ¥ (ê°„ì˜ˆì€)
 - ë‹¤êµ­ì–´ ì§€ì› (KR/JP)
 - ì¹´íŠ¸ (ë¬¼í’ˆ ë‹´ê¸° ê¸°ëŠ¥ ì¶”ê°€) 
 - ì¹´íŠ¸ ì‹¤ì‹œê°„ ê°¯ìˆ˜ í™•ì¸ ê¸°ëŠ¥
 - ?
 
 ---

ìŠ¤í”„ë§ MVCì™€ ìŠ¤í”„ë§ Security 
---
- ìŠ¤í”„ë§ MVC íŒ¨í„´  
<img src="https://user-images.githubusercontent.com/64994827/84133689-6bd7da00-aa82-11ea-987d-68d35283edd4.png"
 width="80%">


- ìŠ¤í”„ë§ Serucity  

<img src="https://user-images.githubusercontent.com/64994827/84133702-6da19d80-aa82-11ea-96d4-67bd44c99d2b.png"
 width="80%">   

---
ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬ MVCíŒ¨í„´ ê¸°ì´ˆ
--




 - 0. ë¨¼ì € ìŠ¤í”„ë§ ê¸°ë³¸ ì„¸íŒ… (log4j, DataSource -DBì—°ë™, ) ë“±ì„ ë‹¤ í•˜ê¸°.   
 - 1. View ( .jsp) ì˜ Formì—ì„œ í˜¹ì€ Ajaxì—ì„œ ì²˜ë¦¬ í•  ë°ì´í„°ë¥¼ URL (Formì˜ Action ì†ì„±) ìœ¼ë¡œ ë§µí•‘ì„ ì‹œí‚¨ë‹¤.  
**jspì˜ formíƒœê·¸ì—ì„œì˜ mapping ì„¤ì •**
 ```
 <form action="/abc" method="GET/POST"> 
 	<input type="text" name="id">
	<input type="password" name="pw">
	<input type="email" name="email">
 </form>
 <!-- actionì— ì“°ì—¬ì§„ /abc ì™€ ê°™ì€ Controllerì— ëª…ì‹œëœ @GetMapping / @PostMapping ("/abc") ë¡œ ê°-->
 <!-- input íƒœê·¸ì˜ name ì€, valueê°’ì„ ê°€ì ¸ê°€ëŠ” ë³€ìˆ˜. ì´ê²ƒì€ Controllerì˜ args ê°’ ì•ˆì— ìë™ì ìœ¼ë¡œ ë“¤ì–´ê°„ë‹¤.-->
 <!-- ë‹¨, VOê°ì²´ ë‚´ì— ë³€ìˆ˜ë¥¼ ì„ ì–¸ í•´ë‘ê³ , getter/setter ì´ ë§Œë“¤ì–´ ì§„ ìƒíƒœì—ì„œ args ëŒ€ì‹  ê°ì²´VOë¡œ ë„£ì–´ì£¼ë©´ ìë™ìœ¼ë¡œ ì´ˆê¸°í™”ê°€ ëœë‹¤.-->
 ```
 - 2. ë§µí•‘ëœ Controller ì—ì„œ Actionì†ì„±ìœ¼ë¡œ ë³´ë‚´ì ¸ ì˜¨ ë°ì´í„° (ID,PWë“±) ì„ ê°€ì§€ê³  ì²˜ë¦¬ í•  ì¤€ë¹„ë¥¼ í•¨.   
![05](https://user-images.githubusercontent.com/64994827/84134859-2c11f200-aa84-11ea-8129-969448bb59bf.png)
 - 3. Controllerì—ì„œ ì²˜ë¦¬ë¥¼ í•˜ì§€ ì•Šê³ , Serviceë¥¼ ì£¼ì… ë°›ì•„ Service ë‹¨ì—ì„œ ì²˜ë¦¬ë¥¼ ì§„í–‰ í•œë‹¤.   
 ![03](https://user-images.githubusercontent.com/64994827/84134856-2ae0c500-aa84-11ea-9afd-b0cb352146bb.png)
 - 4. Serviceì—ì„œëŠ” DBì™€ ì—°ë™ ë˜ì–´ì§„ Mapperë¥¼ ì£¼ì… ë°›ì•„ì„œ DBì™€ ì§ì ‘ ì—°ë™ì„ í•œë‹¤. (ì—¬ê¸°ì„œ Mybatisë¥¼ ì‚¬ìš© > xmlì— ì„¤ì •ì„ í•´ì•¼ í•¨)    
 ![04](https://user-images.githubusercontent.com/64994827/84134857-2b795b80-aa84-11ea-9d0b-1e4bec71870f.png)
 - 5. MapperëŠ” Mapper.xmlê³¼ Mapper Interfaceì™€ ì´ë¦„(ì¸í„°í˜ì´ìŠ¤ ëª… == xml ëª…) ì´ ê°™ì•„ì•¼ í•œë‹¤.   
  ![02](https://user-images.githubusercontent.com/64994827/84134860-2c11f200-aa84-11ea-8367-3dcb1f47de18.png)
 - 6. ì—¬ê¸°ì„œ, Mapper.xmlì€ ì‹¤ì§ˆì ì¸ ì¿¼ë¦¬ë¬¸ì„ ì‘ì„± í•˜ê²Œ ëœë‹¤.
 ```
    <mapper namespace="com.xxx.mapper.Mapper">   
    <!--id : Mapperì•ˆì˜ methodëª… / resultType : ë°˜í™˜ í•  íƒ€ì…-->
    	<select id="xxx" resultType="com.xxx.domain.xxxVO">   
		select * from xxxTable   
	</select>   
    </mapper>   
    
 ```
 - 7. ì´ë ‡ê²Œ Service ë‹¨ì—ì„œ DBì™€ ì—°ë™ ëœ mapper ë¥¼ ì²˜ë¦¬ ë°›ì€ ë°ì´í„° (ë°˜í™˜ ë°ì´í„°-return data)ë¥¼ ë‹¤ì‹œ Controllerì— ëŒë ¤ì£¼ê²Œ ëœë‹¤.   
 - 8. Controllerì—ì„œëŠ” ë°˜í™˜ ë˜ì–´ ì˜¨ ë°ì´í„°ë¥¼ ë‹¤ì‹œ Viewì— ë¿Œë ¤ì¤˜ì•¼ í•œë‹¤. ë§Œì•½ ë°˜í™˜ ëœ ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ì•ˆí•´ì£¼ì–´ë„ ë¬´ê´€í•˜ë‹¤. í•˜ì§€ë§Œ ì‚¬ìš©ìê°€ ê·¸ê²ƒì´ ì¬ëŒ€ë¡œ ë˜ì—ˆëŠ”ì§€ í™•ì¸ì„ í•˜ë ¤ í•œë‹¤ë©´, update, deleteì™€ ê°™ì€ ì‘ì—…ì„ í•  ë–„ëŠ” intí˜•ìœ¼ë¡œ ë°˜í™˜ì„ í•˜ê¸° ë–„ë¬¸ì—, ì‚¼í•­ ì—°ì‚°ìë¥¼ ì´ìš©í•˜ì—¬ true/false ë¥¼ ë§Œë“¤ì–´ ë°˜í™˜í•´ì„œ í™•ì¸í•˜ê²Œ í•˜ë©´ ëœë‹¤.   
 - 9. Controller ì—ì„œ Viewë¡œ ë°˜í™˜ í•  ë–„ëŠ” Servletê³¼ëŠ” ë‹¤ë¥´ê²Œ Modelê°ì²´ë¥¼ ì´ìš©í•˜ì—¬ ë°˜í™˜ í•´ì¤€ë‹¤.   
 - 10. Model ê°ì²´ë¡œ ë°˜í™˜ ë˜ì–´ì§„ ë°ì´í„°ëŠ” Viewë‹¨ì—ì„œ C core íƒœê·¸ì™€ ê°™ì´ ì‚¬ìš©í•  ìˆ˜ ìˆê³ , ë‹¨ì¼ ê°ì²´ í˜¹ì€ ë‹¨ì¼ ë³€ìˆ˜ë§Œì„ ë°˜í™˜ í•˜ì˜€ë‹¤ë©´, ${ë³€ìˆ˜ëª…} í˜¹ì€ ${ê°ì²´ëª….ë³€ìˆ˜ëª…} ì´ë ‡ê²Œ ì¨ì£¼ë©´ ëœë‹¤.   
 
---
ë‹¤ì–‘í•œ ì¿¼ë¦¬ë¬¸ ì‘ì„± ë°©ë²• (mapper.xml)
---
- 1. í˜ì´ì§€ë„¤ì´ì…˜   
```
<![CDATA[	
	 select * from 
(
select/*+ index_desc (ABCTable ABCTable_pk )*/
rownum rn , a.* from ABCTable a
where rownum <= #{pageNum} * #{amount}
) 
where rn > #{pageNum} * #{amount}
]]>
	<!-- ì—¬ê¸°ì„œ pageNum ì€ í˜ì´ì§€ ë²ˆí˜¸ / amount ëŠ” í˜ì´ì§€ë‹¹ ë³´ì—¬ì¤„ ê²Œì‹œë¬¼ ê°¯ìˆ˜ -->
```
- 2. ì¡°íšŒ   
```
<!--ResultType : ë°˜í™˜ í•  íƒ€ì…ì— ëŒ€í•´ì„œ ëª…ì‹œ ; ì˜ˆ) int, com.xxx.domain.oooVO , string ë“±-->
<select id="xxx" resultType="OOO">
	select * from TableName (Where ~ )
	<!-- * ë¶€ë¶„ì—ëŠ” Tableì†ì„± ì¤‘ ì¼ë¶€ë¶„ì„ ë„£ì–´ë„ ë¨-->
</select>
```   

- 3. ì‚½ì…(ì €ì¥)   
```
<insert id="xxx">
	insert into TableName ( ë³€ìˆ˜/ì†ì„± )
	values (ê°’)  
</insert>

ì˜ˆì‹œ) 
<insert id="abc">
	insert into ABCTable (num, name, id)
	values (sequence.nextval, #{name}, #{id})  
</insert>

```
- 4. ì‚­ì œ   
```
<delete id="xxx">
	delete from TableName (where ~)
</delete>
<!--whereì„ ì•ˆì“°ë©´ ëª¨ë“  Table ë‚´ì˜ ë°ì´í„°ë¥¼ ì‚­ì œí•¨-->
```
- 5. ìˆ˜ì •   
```
<update id="xxx">
	update TableName set ë³€ìˆ˜/ì†ì„± = #{ë³€ìˆ˜/ì†ì„±}
</update>

ì˜ˆì‹œ)   
<update id="xxx">
	update ABCTable set name = #{name}
</update>

```
 - ë¶€ë“±í˜¸ ë“± ì„ ì‚¬ìš© í•  ë–„ëŠ” ì•„ë˜ì˜ CDATA ì‚¬ì´ì— ê°’ì„ ë„£ì–´ì£¼ì–´ì•¼ í•œë‹¤.
 ```
 <![CDATA[
 	select * from XXXtable rownum > 0
 ]]>
 ```
  ë§Œì•½ ì´ë ‡ê²Œ í•˜ì§€ ì•Šê³  ì‹¤í–‰ì„ í•˜ë©´ ì—ëŸ¬ê°€ ë‚˜ì˜¨ë‹¤.
  
---
ì¸ì¦ì„œ ì ìš© í•˜ëŠ”ë²• (https://)
---
- ì¸ì¦ì„œ ì ìš© ì „ cmd ê´€ë¦¬ì ì‹¤í–‰ìœ¼ë¡œ ê°€ì•¼ í•©ë‹ˆë‹¤.  
![cmdlocation](https://user-images.githubusercontent.com/64994827/84470392-37e8f880-acbe-11ea-80c2-061d3b8d0f10.png)


- ì¸ì¦ì„œ ìƒì„± (keytool ì´ìš©)
```
<!--jdkì•ˆì— ë‚´ì¥ ëœ Keytoolì„ ì´ìš©í•œ ì¸ì¦ì„œ ë§Œë“¤ê¸°-->
keytool -genkey -alias [ë³„ì¹­] -keyalg RSA -keystore [ì €ì¥í•  íŒŒì¼ëª…].jks
```
- ì¸ì¦ì„œ ì¶”ì¶œ ë° ì €ì¥
```
keytool -export -alias [ë³„ì¹­] -file [ì €ì¥í•  íŒŒì¼ëª…].cer -keystore [ìƒì„±í•œ jksíŒŒì¼]
```
- ì¸ì¦ì„œ í™•ì¸
```
keytool -list -v -keystore [ì¶”ì¶œí•œ íŒŒì¼ jksëª…]
```

 - í†°ì¼“ ì„¤ì •
 ```
 <Connector port="8443" protocol="HTTP/1.1" SSLEnabled="true"
               maxThreads="150" scheme="https" secure="true"
               clientAuth="false" sslProtocol="TLS" keystorePass="[ìƒì„±í•œ ì¸ì¦ì„œ ë¹„ë°€ë²ˆí˜¸]" 
               keystoreFile="[ì €ì¥ëœ ì¸ì¦ì„œ íŒŒì¼ ê²½ë¡œ]/[íŒŒì¼ëª…]"/>
```
 - security-context.xml ì„¤ì •
 ```
 <intercept-url pattern="/**" access="permitAll" requires-channel="https" />
ì´ëŸ°ì‹ìœ¼ë¡œ requires-channel = "https" ë¥¼ ì ìš© í•´ì¤€ë‹¤.
 ```
 - Web.xml ì„¤ì •
 ```
 <security-constraint>
		<web-resource-collection>
			<web-resource-name>SSL Redirect</web-resource-name>
				<url-pattern>/*</url-pattern>
			</web-resource-collection>
		<user-data-constraint>
		<transport-guarantee>CONFIDENTIAL</transport-guarantee>
	</user-data-constraint>
</security-constraint>
<!--SSL ë° https ì ìš©ì´ ë˜ê¸° ìœ„í•œ xmlì„¤ì •-->

 ```
  - certification í´ë” ì•ˆì— ìˆëŠ” ê²ƒë“¤ì€ C:\Program Files\Java\jdk1.8.0_241\bin ì— ë„£ì–´ì„œ ì ìš© í•  ê²ƒ.
  
---
ì½”ë“œ ì„¤ëª… (ê¸°ëŠ¥)   
===
1.ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ë¥¼ ì´ìš©í•œ ë¡œê·¸ì¸, íšŒì›ê°€ì…  ì„¤ëª… ê³¼ ì„¸íŒ… 
---   
1-1. íšŒì›ê°€ì…ì˜ ì½”ë“œ ì„¤ëª…ê³¼ ì„¸íŒ…
#ìŠ¤í”„ë§ ë³´ì•ˆ (Spring security) Dependency ì„¤ì •
```
<!--ìŠ¤í”„ë§ ë³´ì•ˆ pom.xml ì— ì˜ì¡´ì„± ì¶”ê°€-->
                 <dependency>
			<groupId>org.springframework.security</groupId>
			<artifactId>spring-security-core</artifactId>
			<version>5.3.3.RELEASE</version>
		</dependency>

		<dependency>
			<groupId>org.springframework.security</groupId>
			<artifactId>spring-security-web</artifactId>
			<version>5.3.3.RELEASE</version>
		</dependency>
		<dependency>
			<groupId>org.springframework.security</groupId>
			<artifactId>spring-security-config</artifactId>
			<version>5.3.3.RELEASE</version>
		</dependency>
		<dependency>
			<groupId>org.springframework.security</groupId>
			<artifactId>spring-security-taglibs</artifactId>
			<version>5.3.3.RELEASE</version>
		</dependency>
		<dependency>
			<groupId>org.springframework.security</groupId>
			<artifactId>spring-security-test</artifactId>
			<version>5.3.3.RELEASE</version>
		</dependency>
```
ê·¸ ë‹¤ìŒ
**Security-context.xml** ì—ì„œ ì„¤ì •ì„ í•´ì¤˜ì•¼ Spring Security ë¥¼ ì‚¬ìš© í•  ìˆ˜ ìˆë‹¤.
```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:security="http://www.springframework.org/schema/security"
	xsi:schemaLocation="http://www.springframework.org/schema/beans 
	http://www.springframework.org/schema/beans/spring-beans.xsd
	http://www.springframework.org/schema/security 
	http://www.springframework.org/schema/security/spring-security.xsd">
	
	...ìƒëµ
```
**Web.xml** ì¶”ê°€ ì„¤ì •
```
	<filter>
		<filter-name>springSecurityFilterChain</filter-name>
		<filter-class>org.springframework.web.filter.DelegatingFilterProxy
		</filter-class>
	</filter>
	<filter-mapping>
		<filter-name>springSecurityFilterChain</filter-name>
		<url-pattern>/*</url-pattern>
	</filter-mapping>
```
**CustomLogin.JSP Page**ì—ì„œ Form Tags
```
<form class="login100-form validate-form" action="/signup" method="post">
<input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token }">
```
ì—¬ê¸°ì„œ 
```
<input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token }">
```
ëŠ” **Method='POST'** ì¼ ë–„ëŠ” ë¬´ì¡°ê±´ ì‚¬ìš© í•´ì•¼ **Security** ì—ì„œ ì •ìƒì ìœ¼ë¡œ ì‘ë™ í•˜ì—¬ Requestë¡œ í—ˆê°€ë¥¼ ë³´ëƒ…ë‹ˆë‹¤.
ê·¸ í›„ì— **action="/signup"** ì˜ URLì´ ì íŒ Controller ë¡œ ì´ë™ í•©ë‹ˆë‹¤.

**Controller** ì—ì„œëŠ” 
**URLì´ /signup** ì¸ ê³³ì— Request Mapping ë˜ì–´ ìš”ì²­ì„ í•©ë‹ˆë‹¤.
ì´ìœ ëŠ” **Method='POST'** ì´ê¸° ë–„ë¬¸ì— 
```
@GetMapping 
```
ì´ ì•„ë‹Œ 
```
@PostMapping
```
ìœ¼ë¡œ ê°‘ë‹ˆë‹¤.   
   
**Controller**
```
<!--serviceë¥¼ ì»¨íŠ¸ë¡¤ëŸ¬ì— ì£¼ì…-->

	@Setter(onMethod_ = { @Autowired })
	private MemberService service;

	@PostMapping("/signup")
	public String signup(MemberVO memvo) throws UnsupportedEncodingException, SQLException {
		log.info("error : " + memvo);
		if (service.signup(memvo)) {
			service.Account_loginto(memvo.getUserid());
			log.info("sign up success");
		} 
		return "redirect:/CustomLogin";
	}
```
ë¨¼ì € ì•„ë˜ì— ì‹¤í–‰ë˜ëŠ” ìˆœì„œëŒ€ë¡œ ì½”ë“œë¥¼ ë³´ì—¬ì£¼ê³  ì„¤ëª… í•˜ê² ìŠµë‹ˆë‹¤.

**MemberVO**
```
@Getter
@Setter
@ToString
public class MemberVO {
<!-- ì¸ì¦ì— í•„ìš”í•œ ìœ ì € ì •ë³´ VO-->
	
	private String userid;
	private String userpw,userName;
	private String useremail;
	
	private boolean enabled;
	private String regDate;
	private Date updateDate;
	private List<AuthVO> authList;
	<!--ìœ ì € ê¶Œí•œ ì •ë³´ê°€ ë“¤ì–´ê°€ ìˆëŠ” VO-->

}

```
**MemberService**
```

public interface MemberService {

	public boolean signup(MemberVO mvo);
	
	...ìƒëµ
}
```

**MemberServiceImpl**
```
	@Setter(onMethod_ = { @Autowired })
	private MemberMapper mapper;
	<!--mapper ì£¼ì…-->
	
	@Inject
	private BCryptPasswordEncoder BCPE;
	<!--Serurityì— ìˆëŠ” ì•”í˜¸í™” -->
	
	@Override
	public boolean signup(MemberVO mvo) {
		log.info("on");
		// TODO Auto-generated method stub
		mvo.setUserpw(BCPE.encode(mvo.getUserpw()));
		mapper.insert(mvo);

		MailSendMethod(mvo);
		return mapper.insert_auth(mvo) == 1 ? true : false;

	}
```
**MemberMapper**
```

public interface MemberMapper {

	public int insert(MemberVO mvo);
	public int insert_auth(MemberVO mvo);
	
	...ìƒëµ
```
**MemberMapper.xml**
```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.rental.mapper.MemberMapper">
	<insert id="insert">
		insert into tbl_member (userid, userpw, username,
		regdate, enabled, useremail) values
		(#{userid}, #{userpw}, 'ì¼ë°˜ì‚¬ìš©ì'
		,sysdate,0, #{useremail})
	</insert>
	<insert id="insert_auth">
		insert into tbl_member_auth (userid, auth ) values
		(#{userid} , 'ROLE_USER' )
	</insert>

	... ìƒëµ
```
ìŠ¤í”„ë§ì—ì„œ JSPì˜ Form actionê³¼ Method ì— ë”°ë¼
Controller ì˜ @GetMapping / @PostMapping ì— actionì— ì íŒ ë¬¸ì( ì˜ˆ: /signup ) ì™€ ê°™ì€ ë¬¸ìê°€ ì íŒ ê³³ìœ¼ë¡œ ë§µí•‘ ë©ë‹ˆë‹¤.
ê·¸ ë‹¤ìŒ, Controller ì˜ @PostMapping("/signup") ì˜
```
@PostMapping("/signup")
	public String signup(MemberVO memvo) throws UnsupportedEncodingException, SQLException {
		if (service.signup(memvo)) {
			service.Account_loginto(memvo.getUserid());
			log.info("sign up success");
		} 
	}
```
ìœ¼ë¡œ ì™€ì„œ  ifë¬¸ ì•ˆì˜ **service.signup()** ì„ ì‹¤í–‰ í•©ë‹ˆë‹¤.
ì‹¤í–‰ í•˜ê¸° ì „ì— 
```
@Setter(onMethod_ = { @Autowired })
	private MemberService service;
```
ê°€ ì˜ì¡´ì£¼ì…ì´ ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.
ê·¸ë¦¬ê³  **service.signup()** ì€
**MemberService Interfaceë¥¼ ìƒì†ë°›ì€ MemberServiceImpl** ì—ì„œ ì‹¤í–‰í•©ë‹ˆë‹¤. 
```
@Override
	public boolean signup(MemberVO mvo) {
	mvo.setUserpw(BCPE.encode(mvo.getUserpw()));
		mapper.insert(mvo);
		return mapper.insert_auth(mvo) == 1 ? true : false;
	}
```
ì—¬ê¸°ì„œ BCPE.encode(-) ëŠ” ì•”í˜¸í™” ì…ë‹ˆë‹¤.
ê·¸ê²ƒì„ ê°ì²´ MemberVO ì˜ UserPwì— ë‹¤ì‹œ ì´ˆê¸°í™”ë¥¼ í•´ì¤€ ë’¤,  
~~íšŒì›ê°€ì… ë–„ ì…ë ¥ í•œ userid, useremail, userpw ì€ ìë™ì ìœ¼ë¡œ ê°ì²´ MemberVOì— Set ë©ë‹ˆë‹¤.~~  
Oracle DataBase ì˜ Member í…Œì´ë¸”ì— ë„£ì–´ì£¼ëŠ” SQLë¬¸ì„ ì‹¤í–‰ í•©ë‹ˆë‹¤.

```
<insert id="insert">
		insert into tbl_member (userid, userpw, username,
		regdate, enabled, useremail) values
		(#{userid}, #{userpw}, 'ì¼ë°˜ì‚¬ìš©ì'
		,sysdate,0, #{useremail})
	</insert>
```
MemberVOì˜ ê°ì²´ì— ì €ì¥ëœ ë³€ìˆ˜ê°€ Mapper.xml ì—ì„œ Mybatisì— ì˜í•´ì„œ   
#{íŒŒë¼ë¯¸í„°} ì— ìë™ì ìœ¼ë¡œ ë“¤ì–´ê°€ì„œ SQLë¬¸ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.   
 - ìœ„ì˜ mapper.insert_authë„ ë§ˆì°¬ê°€ì§€ë¡œ ì‘ë™ì„ í•˜ë©°, ê¶Œí•œì„ ë¶€ì—¬í•´ì£¼ëŠ” ì„œë¹„ìŠ¤ ë¡œì§ì…ë‹ˆë‹¤.
   ì´ëŸ¬í•œ íë¦„ëŒ€ë¡œ ë˜ë©°, íšŒì›ê°€ì…ì´ ì •ìƒì ìœ¼ë¡œ ë©ë‹ˆë‹¤.
---

1-2.ë¡œê·¸ì¸ ì½”ë“œ ì„¤ëª…   
---
**CustomLogin.jsp** ë‚´ì˜ ë¡œê·¸ì¸ Form ì½”ë“œ
```
<form class="login100-form validate-form" action="/login"method="post">
<input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token }"> 
```
**AuthenticationProvider**
```
@Log4j
@Component
public class CustomAuthenticationProvider implements AuthenticationProvider {
	@Override
	public Authentication authenticate(Authentication authentication) throws AuthenticationException {
	String username = (String) authentication.getPrincipal();
	String password = (String) authentication.getCredentials();
	log.debug("AuthenticationProvider :::::: 1");

	CustomUser user = (CustomUser) service.loadUserByUsername(username);
	
	...ìƒëµ
	
	return new UsernamePasswordAuthenticationToken(user, user, user.getAuthorities());
	}
	
	@Override
	public boolean supports(Class<?> authentication) {
		return true;
	}
}
```
**UserDetailsService**
```
@Log4j
public class CustomUserDetailsService implements UserDetailsService {
	@Override
	public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {
		// TODO Auto-generated method stub
		log.warn("Load User & UserName : " + username);
		
		// userName means userid
		MemberVO vo = mapper.read(username);

		log.warn("queried by member mapper :" + vo);
		return vo == null ? null : new CustomUser(vo);
	}
}
```
**LoginSuccessHandler**
```
@Log4j
public class CustomLoginSuccessHandler implements AuthenticationSuccessHandler {
	
@Override
	public void onAuthenticationSuccess(HttpServletRequest request, HttpServletResponse response,
			Authentication auth) throws IOException, ServletException {
		// TODO Auto-generated method stub
		log.warn("Login Success");

		List<String> roleNames = new ArrayList<>();

		auth.getAuthorities().forEach(authority -> {
			roleNames.add(authority.getAuthority());
		});
		log.warn("ROLE NAMES : " + roleNames);
		service.UserLoginSuccess(auth.getName());
		if(roleNames.contains("ROLE_ADMIN")) {
			response.sendRedirect("/admin/index?userid="+auth.getName());		
			return;
		}
		if(roleNames.contains("ROLE_USER")) {
			service.UserLoginSuccess(auth.getName());
			response.sendRedirect("/");
			return;
		}	
		response.sendRedirect("/");
	}
}
```

ë¡œê·¸ì¸ì„ í•˜ë©´, Login.jsp ì—ì„œ Security Filterë¥¼ ê±°ì³ì„œ ìœ„ì˜ ìˆœì„œì²˜ëŸ¼   
**AuthenticationProvider** ì—ì„œ ë¨¼ì € DBì—ì„œ ìœ ì €ì˜ ê¶Œí•œì„ ì²´í¬ í•˜ê³ ë‚˜ì„œ **UserDetailsService** ì—ì„œ ìœ ì € ì •ë³´ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.   
ê°€ì ¸ì˜¨ ìœ ì € ì •ë³´ë¥¼ ìë™ìœ¼ë¡œ ì„¸ì…˜ ë§Œë“¤ì–´ ì¤ë‹ˆë‹¤.   
ê·¸ ë’¤ì— **LoginSuccessHandler** ì—ì„œ ì„±ê³µì ìœ¼ë¡œ ë¡œê·¸ì¸ì´ ë˜ì—ˆë‹¤ë©´, ê° ê¶Œí•œì— ë”°ë¼ response.sendRedirect ì— ëœ URLë¡œ ì´ë™ì„ í•©ë‹ˆë‹¤.   
ìœ ì €ë¼ë©´ ë©”ì¸í™”ë©´ìœ¼ë¡œ, ê´€ë¦¬ìë¼ë©´ ê´€ë¦¬ì í˜ì´ì§€ë¡œ ì´ë™í•˜ê²Œ ì„¤ì •ì´ ë˜ì–´ìˆìŠµë‹ˆë‹¤.   

---
2.ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ë° ì•„ì´ë”” ì°¾ê¸° ê¸°ëŠ¥
---
**forgot.jsp** ì˜ Ajax
```
<script type="text/javascript">
$(function() {
var csrfHeaderName = "${_csrf.headerName}";
var csrfTokenValue = "${_csrf.token}";
$(document).ajaxSend(function(e, xhr, options) {
	xhr.setRequestHeader(csrfHeaderName, csrfTokenValue);
})
$("#submit").on("click",function() {
	if (!$("input[name='userid']").val()) {
		alert("ì•„ì´ë””ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
		return false;
	}
	if (!$("input[name='userpw']").val()) {
		alert("ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
		return false;
	}
	let userid = $("input[name='userid']").val();
	let userpw = $("input[name='userpw']").val();
	$.ajax({
		url : "/forgot/reset",
		type : 'POST',
		data : JSON.stringify({
			"userid" : userid,
			"userpw" : userpw
		}),
		dataType : "text",
		contentType : "application/json; charset=UTF-8",
		processData : false,
		success : function(result) {

			$(opener.document).find("#change").text(
					"ì •ìƒì ìœ¼ë¡œ ë¹„ë°€ë²ˆí˜¸ê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.");
			self.close();
			return;

		},
		error : function(req, status, error) {
			console.log("req" + req + "status " + status
					+ " error " + error);
		}
	})
})
</script>
```

**MainController - Ajax**
```
@ResponseBody
@PostMapping(value = "/forgot/reset", produces = MediaType.APPLICATION_JSON_UTF8_VALUE)
public ResponseEntity<String> Reset(@RequestBody String recommend, HttpServletResponse res, HttpServletRequest req)
		throws JsonParseException, JsonMappingException, IOException {
		
		...ìƒëµ
		
	return new ResponseEntity<>(userpw, HttpStatus.OK);

}

@ResponseBody
@PostMapping(value = "/forgot/findId", produces = MediaType.APPLICATION_JSON_UTF8_VALUE)
public ResponseEntity<String> FindId(@RequestBody String recommend, HttpServletResponse res, HttpServletRequest req)
		throws JsonParseException, JsonMappingException, IOException {

	...

	return new ResponseEntity<>(mvo.getUserid(), HttpStatus.OK);

}
```

**ServiceImpl**
```
@Override
	public String Reset(MemberVO mvo) {
		// TODO Auto-generated method stub
		String userpw = BCPE.encode(mvo.getUserpw());
		mvo.setUserpw(userpw);
		mapper.Reset(mvo);
		return mvo.getUserpw();
	}
	
@Override
	public MemberVO FindId(MemberVO mvo) {
		// TODO Auto-generated method stub
		return mapper.FindId(mvo);
	}
```
Jspì˜ Ajax --> Controller --> Service --> DB ë¡œ ê°‘ë‹ˆë‹¤.

ê·¸ë˜ì„œ ì•„ì´ë””ë¥¼ ì°¾ì„ ë–„ëŠ” ì•„ì´ë””ë¥¼ ì°¾ì•„ì„œ ë°˜í™˜í•´ì£¼ê³    
ë¹„ë°€ë²ˆí˜¸ë¥¼ ë°”ê¿€ë–„ëŠ” ì¬ì°¨ ì•”í˜¸í™”ë¥¼ í•œ ë’¤ì— ë°”ë€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë°˜í™˜ í•´ì£¼ì–´ ìœ ì €ê°€ ì•Œ ìˆ˜ ìˆë„ë¡ í™”ë©´ì— ë„ì›Œì£¼ê²Œ ë©ë‹ˆë‹¤.


---
  
  3.ë¬¼í’ˆ ë“±ë¡ ë° ë¬¼í’ˆ ì˜ˆì•½ ì½”ë“œ ì„¤ëª…ê³¼ ìˆœì„œ
  ---
  
  ë¬¼í’ˆ ë“±ë¡ì€ **ê´€ë¦¬ì** ê°€ í•˜ê²Œ ë©ë‹ˆë‹¤.    
  ê·¸ë ‡ì§€ë§Œ, ë¬¼í’ˆ ì˜ˆì•½ê³¼ ì˜ˆì•½ ëœ ë¬¼í’ˆì„ í™•ì¸í•˜ëŠ” ê²ƒì€ **ì‚¬ìš©ì** ì…ë‹ˆë‹¤.
  ìˆœì°¨ëŒ€ë¡œ ì‘ì„± í•˜ê² ìŠµë‹ˆë‹¤.   
  
  **ProductController**
  ```
  @Controller
@Log4j
@RequestMapping(value = "/product/*")
public class ProductControll {

	@GetMapping("/write")
	public void productregister() {
		log.info("product writing");

	}
	
	...ìƒëµ
	
	@PostMapping("/write")
	public String productregisterAction(ProductVO product, RedirectAttributes rttr) {
		log.info("productregisterAction");

		MultipartFile multipartFile = product.getGoodsfile();
		
		...ìƒëµ
		
		try {
			multipartFile.transferTo(saveFile);
		} catch (Exception e) {
			log.error(e.getMessage());
		}
		
		service.insert(product);
		return "redirect:/product/product";
	}
}
  ```
  **SPRING SECURITY** ì—ì„œ íŒŒì¼ì„ ì²¨ë¶€í•˜ë ¤ë©´ ì„¤ì •ì„ ì¶”ê°€ í•´ì¤˜ì•¼ í•©ë‹ˆë‹¤.
  
  **Web.xml** ì—ì„œ    
  ```
  <filter>
	<display-name>springMultipartFilter</display-name>
	<filter-name>springMultipartFilter</filter-name>
	<filter-class>org.springframework.web.multipart.support.MultipartFilter
	</filter-class>
</filter>
<filter-mapping>
	<filter-name>springMultipartFilter</filter-name>
	<url-pattern>/*</url-pattern>
</filter-mapping>
  ```
  ì´ê²ƒì„ 
  ```
<filter>
	<filter-name>springSecurityFilterChain</filter-name>
	<filter-class>org.springframework.web.filter.DelegatingFilterProxy
	</filter-class>
</filter>
<filter-mapping>
	<filter-name>springSecurityFilterChain</filter-name>
	<url-pattern>/*</url-pattern>
</filter-mapping>
  ```
  ì•ì— ì¶”ê°€ë¥¼ í•´ì£¼ì–´ì•¼ ì¬ëŒ€ë¡œ ì •ìƒ ì‘ë™ í•˜ê²Œ ë©ë‹ˆë‹¤.
 ```
 @Service
@AllArgsConstructor
public class ProductServiceImpl implements ProductService {

	...ìƒëµ
	@Override
	public void insert(ProductVO pvo) {
		// TODO Auto-generated method stub
		mapper.insert(pvo);
	}
	
	...ìƒëµ
}
 ```
ê·¸ ë’¤, ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ  Service ë¡œ ë„˜ì–´ì˜¤ê³ , ì´ ì„œë¹„ìŠ¤ì—ì„œ ë‹¤ì‹œ Mapperë¥¼ í˜¸ì¶œí•˜ì—¬ DBì— ì €ì¥ì„ í•˜ê²Œ ë©ë‹ˆë‹¤.
```
public interface ProductMapper {
		public void insert(ProductVO pvo);
}
```

  
  ---
  4.ì˜ˆì•½ ë¬¸ì˜ ê¸°ëŠ¥ ì½”ë“œ ìˆœì„œ 
  ---
  **Inquire.jsp**
  
  ```
  <form class="form-contact contact_form" action="/contact/mail" method="post" id="contactForm" novalidate="novalidate">
  <input type="hidden" value="${_csrf.token }" name="${_csrf.parameterName }">
  ```
  
  **Controller**
  ```
@Setter(onMethod_ = { @Autowired })
private ConTactService cs;

@PostMapping("/contact/mail")
public String mail(ConTactVO cvo) {
	cs.insert(cvo);

	return "redirect:/contact/contact";
}
  ```
  **ConTactServiceImpl**
  ```
@Override
public void insert(ConTactVO cvo) {
	// TODO Auto-generated method stub
	mapper.insert(cvo);
}
  ```
  **ConTactMapper**
  ```
  public interface ConTactMapper {
  
	public void insert(ConTactVO cvo);
	
  ```
  
  
  ---
  5.Ajaxë¥¼ ì´ìš©í•˜ì—¬ ì‹¤ì‹œê°„ ì¢‹ì•„ìš”/ì‹«ì–´ìš” ê¸°ëŠ¥ ë° ì½”ë“œ ìˆœì„œ
  ---
  
 **Notice/View.jsp - Javascipt / Ajax**
  ```
  $("#commend #likes").on("click",function(){
	$(document).ajaxSend(function(e, xhr, options) {
		xhr.setRequestHeader(csrfHeaderName, csrfTokenValue);
	})

	...ìƒëµ
	
	$.ajax({
		url : "/likes",
		type : 'POST',
		data : JSON.stringify({
			"userid" : userid,
			"num" : n_num,
			"n_num" : sequence
		}),
		contentType : "application/json; charset=UTF-8",
		processData : false,
		success : function(result) {
			console.log(result);
			lik[0].innerText=result.likes;
		},
		error : function(req, status, error) {
			console.log(error);
		}
	})
});
$("#commend li #hates").on("click",function(){
	$(document).ajaxSend(function(e, xhr, options) {
		xhr.setRequestHeader(csrfHeaderName, csrfTokenValue);
	})
	
	...ìƒëµ
	
	$.ajax({
		url : "/hates",
		type : 'POST',
		data : JSON.stringify({
			"userid" : userid,
			"num" : n_num,
			"n_num" : sequence
	}),
		contentType : "application/json; charset=UTF-8",
		processData : false,
		success : function(result) {
			lik[0].innerText=result.hates;
		},
		error : function(req, status, error) {
			console.log(error);
		}
	})
});
  ```
  **Controller**
  
  ```
  @Setter(onMethod_ = { @Autowired })
	private ReplyService rs;

  @ResponseBody
	@PostMapping(value = "/likes", produces = MediaType.APPLICATION_JSON_UTF8_VALUE)
	public ResponseEntity<Object> likes(@RequestBody String recommend, HttpServletResponse res, HttpServletRequest req)
			throws JsonParseException, JsonMappingException, IOException {

		...ìƒëµ
		
		 rs.likes(rvo) 
		return new ResponseEntity<>(rs.Yreply(rvo), HttpStatus.OK);
	}

	@ResponseBody
	@PostMapping(value = "/hates", produces = MediaType.APPLICATION_JSON_UTF8_VALUE)
	public ResponseEntity<Object> hates(@RequestBody String recommend, HttpServletResponse res, HttpServletRequest req)
			throws JsonParseException, JsonMappingException, IOException {

		...ìƒëµ
		
		 rs.hates(rvo);
		return new ResponseEntity<>(rs.Yreply(rvo), HttpStatus.OK);
	}
  ```
  **ReplyServiceImpl**
  ```
 @Service
public class ReplyServiceImpl implements ReplyService {

  @Override
	public int hates(ReplyVO rvo) {
		// TODO Auto-generated method stub
		return mapper.hates(rvo);
	}
	@Override
	public int likes(ReplyVO rvo) {
		// TODO Auto-generated method stub
		return mapper.likes(rvo);
	}

	@Override
	public ReplyVO Yreply(ReplyVO rvo) {
		// TODO Auto-generated method stub
		return mapper.Yreply(rvo);
	}
}
  ```
  **ReplyMapper**
  ```
  
public interface ReplyMapper {
	public int likes(ReplyVO rvo);

	public int hates(ReplyVO rvo);

	public ReplyVO Yreply(ReplyVO rvo);
}
  ```
  
  6.ë¡œê·¸ì¸ íšŸìˆ˜, ë¡œê·¸ì¸ ëˆ„ì  ì‹¤íŒ¨ íšŸìˆ˜ , ì˜ˆì•½ íšŸìˆ˜ ê¸°ëŠ¥ ë° ì½”ë“œ ì„¤ëª…
  ---

**AuthenticationProvider**
**ë¡œê·¸ì¸ í•  ë–„, ìš”ì²­ì„ ê°€ë¡œì±„ì„œ AuthenticationProvider ì—ì„œ ë¨¼ì € ì²˜ë¦¬ë¥¼ í•œë‹¤**
**ë¡œê·¸ì¸ ë° ëˆ„ì  ì‹¤íŒ¨ ë“±ì„ ì•Œë ¤ì£¼ëŠ” ì½”ë“œ**
```
		...ìƒëµ...

if (!pass.matches(password, user.getPassword())) {
	log.debug("matchPassword :::::::: false!");
	mapper.UserLoginFail(user.getUsername()); <!--ë¹„ë°€ë²ˆí˜¸ ì‹¤íŒ¨ ì‹œ, ì‹¤íŒ¨ íšŸìˆ˜ ì¦ê°€ -->
	throw new BadCredentialsException(ACCOUNT_NOT_PASSWORD_ERROR);
}
if (mapper.UserLogInfo(user.getUsername()).getFail_count() >= 10) {
	log.debug("ê³„ì • ì ê¸ˆ");
	mmapper.DisEnabled(user.getUsername()); <!-- ë¹„ë°€ë²ˆí˜¸ 10íšŒ ì´ìƒ ì‹¤íŒ¨ ì‹œ, ê³„ì • ì ê¸ˆ -->
	throw new LockedException(ACCOUNT_DISENABLE_ERROR);
}

log.debug("User Enabled : " + user.isEnabled());
log.debug("User Enabled : " + user.isAccountNonLocked());


if (!user.isEnabled()) { <!-- íšŒì› ê°€ì… í›„, ì´ë©”ì¼ ì¸ì¦ì´ ì•ˆë¬ì„ ì‹œ, ì´ë©”ì¼ ì¸ì¦ì„ í•˜ë¼ëŠ” ë©”ì‹œì§€ë¥¼ Customerì—ê²Œ ì¶œë ¥-->
	log.debug("isEnabled :::::::: false!");
	log.info("ì´ë©”ì¼ ì¸ì¦ì„ í•´ì£¼ì‹œê¸¸ ë°”ëë‹ˆë‹¤."); 
	throw new DisabledException(ACCOUNT_NOT_EMAIL_AUTH);
}

log.debug("matchPassword :::::::: true!");
mapper.FullFailCount(user.getUsername()); <!--ë¡œê·¸ì¸ì´ ì„±ê³µì ìœ¼ë¡œ ë˜ì—ˆì„ ì‹œ, ì‹¤íŒ¨ íšŸìˆ˜ë¥¼ 0ìœ¼ë¡œ ë§Œë“¤ê³ , ëˆ„ì  ì‹¤íŒ¨ íšŸìˆ˜ì— í†µí•©ì‹œí‚¨ë‹¤ -->
log.info("ì„±ê³µì ì¸ ë¡œê·¸ì¸");

...ìƒëµ...
```
**mapper.FullfailCount ì— ì‚¬ìš©í•œ ë¡œê·¸ì¸ ì‹¤íŒ¨ íšŸìˆ˜ ëˆ„ì  í”„ë¡œì‹œì € (Procedure) ë° mapper.xml ì½”ë“œ**
```
mapper.xml ì½”ë“œ

...ìƒëµ...
<update id="FullFailCount">
call updates 
( #{userid} )
</update>
...ìƒëµ...

í”„ë¡œì‹œì € ì½”ë“œ 
create or replace PROCEDURE updates
(  ids IN inlog.userid%type )
   is
    begin
    update inlog set login_count = login_count + 1 where userid = ids;
    update inlog set fullfail_count = fail_count + fullfail_count where userid = ids;
    update inlog set fail_count = 0 where userid = ids ;
commit;
end updates;
```
**ì˜ˆì•½ íšŸìˆ˜ ì¹´ìš´íŠ¸**
**UserController**
```
@Controller
@RequestMapping(value="/users/*", method = {RequestMethod.GET,RequestMethod.POST})
public class UserController {

		...ìƒëµ...

	@GetMapping("/Reservation")
	public void Reservation(String userid, Model model, Criteria cri) {
		
		...ìƒëµ...
		
		//ë‹¤ì¤‘ íŒŒë¼ë¯¸í„°ë¥¼ mybatisë¡œ ë³´ë‚¼ë–„ 
		HashMap<String, Object> map = new HashMap<String, Object>();
		map.put("userid", userid);
		map.put("pageNum" , cri.getPageNum());
		map.put("amount", cri.getAmount());

		model.addAttribute("count",rst.count(userid));
		
		...ìƒëµ...
	}
}
```
**ResTableMapper**
```
	...ìƒëµ...
	
<select id="pageList" parameterType="hashmap" resultType="com.rental.domain.ResTableVO">
<![CDATA[	
	select B.* from ( select /*+ index_desc (res_table res_table_pk )*/  rownum r, A.* from 
	(
	select/*+ index_desc (res_table res_table_pk )*/
		rownum rn, res_table.* from res_table
	) A
	where rn > (#{pageNum}-1)*#{amount} and userid = #{userid}  ) B where r <= #{pageNum} * #{amount} 
]]>
</select>
```
